PRAGMA foreign_keys = ON
üìä –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö...
CREATE TABLE IF NOT EXISTS users (
            id INTEGER PRIMARY KEY,
            telegram_id INTEGER UNIQUE NOT NULL,
            username TEXT,
            first_name TEXT,
            last_name TEXT,
            phone_number TEXT,
            created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
            updated_at DATETIME DEFAULT CURRENT_TIMESTAMP
        )
    
CREATE TABLE IF NOT EXISTS orders (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            user_id INTEGER NOT NULL,
            order_number TEXT UNIQUE NOT NULL,
            status TEXT DEFAULT 'new',
            total_amount REAL NOT NULL,
            promo_code TEXT,
            discount_amount REAL DEFAULT 0,
            notes TEXT,
            created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
            updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,
            FOREIGN KEY (user_id) REFERENCES users(id)
        )
    
CREATE TABLE IF NOT EXISTS order_items (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            order_id INTEGER NOT NULL,
            product_id INTEGER NOT NULL,
            product_name TEXT NOT NULL,
            product_price REAL NOT NULL,
            quantity INTEGER NOT NULL,
            subtotal REAL NOT NULL,
            FOREIGN KEY (order_id) REFERENCES orders(id) ON DELETE CASCADE
        )
    
CREATE TABLE IF NOT EXISTS promo_codes (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            code TEXT UNIQUE NOT NULL,
            discount_type TEXT NOT NULL,
            discount_value REAL NOT NULL,
            min_order_amount REAL DEFAULT 0,
            max_uses INTEGER,
            used_count INTEGER DEFAULT 0,
            expires_at DATETIME,
            is_active BOOLEAN DEFAULT 1,
            created_at DATETIME DEFAULT CURRENT_TIMESTAMP
        )
    
CREATE TABLE IF NOT EXISTS promo_usage (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            promo_code_id INTEGER NOT NULL,
            user_id INTEGER NOT NULL,
            order_id INTEGER NOT NULL,
            used_at DATETIME DEFAULT CURRENT_TIMESTAMP,
            FOREIGN KEY (promo_code_id) REFERENCES promo_codes(id),
            FOREIGN KEY (user_id) REFERENCES users(id),
            FOREIGN KEY (order_id) REFERENCES orders(id)
        )
    
CREATE INDEX IF NOT EXISTS idx_orders_user_id ON orders(user_id);
CREATE INDEX IF NOT EXISTS idx_orders_status ON orders(status);
CREATE INDEX IF NOT EXISTS idx_orders_created_at ON orders(created_at);
CREATE INDEX IF NOT EXISTS idx_order_items_order_id ON order_items(order_id);
‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ —É—Å–ø–µ—à–Ω–æ!
üöÄ –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω!
üåê –í–µ–±-—Å–µ—Ä–≤–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É 3000
üì± Web App URL: https://unimmaculately-unogled-savanna.ngrok-free.dev -> http://localhost:3000
üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: Rate limiting, CORS, Headers, Validation ‚úì
Reading products from: /Users/nxdms/Desktop/techbot/public/products.json
Loaded products count: 5
Returning products count: 5
Reading products from: /Users/nxdms/Desktop/techbot/public/products.json
Loaded products count: 5
Returning products count: 5
Reading products from: /Users/nxdms/Desktop/techbot/public/products.json
Loaded products count: 5
Returning products count: 5
Reading products from: /Users/nxdms/Desktop/techbot/public/products.json
Loaded products count: 5
Returning products count: 5
Reading products from: /Users/nxdms/Desktop/techbot/public/products.json
Loaded products count: 5
Returning products count: 5
Reading products from: /Users/nxdms/Desktop/techbot/public/products.json
Loaded products count: 5
Returning products count: 5
Reading products from: /Users/nxdms/Desktop/techbot/public/products.json
Loaded products count: 5
Returning products count: 5
Reading products from: /Users/nxdms/Desktop/techbot/public/products.json
Loaded products count: 5
Returning products count: 5
Reading products from: /Users/nxdms/Desktop/techbot/public/products.json
Loaded products count: 5
Returning products count: 5
Reading products from: /Users/nxdms/Desktop/techbot/public/products.json
Loaded products count: 5
Returning products count: 5
Reading products from: /Users/nxdms/Desktop/techbot/public/products.json
Loaded products count: 5
Returning products count: 5
Reading products from: /Users/nxdms/Desktop/techbot/public/products.json
Loaded products count: 5
Returning products count: 5
Reading products from: /Users/nxdms/Desktop/techbot/public/products.json
Loaded products count: 5
Returning products count: 5
Reading products from: /Users/nxdms/Desktop/techbot/public/products.json
Loaded products count: 5
Returning products count: 5
[2025-11-19T10:33:58.953Z] –û—à–∏–±–∫–∞ polling: EFATAL
Reading products from: /Users/nxdms/Desktop/techbot/public/products.json
Loaded products count: 5
Returning products count: 5
[2025-11-19T12:44:03.544Z] –û—à–∏–±–∫–∞ polling: ETELEGRAM
[2025-11-19T12:44:10.949Z] –û—à–∏–±–∫–∞ polling: ETELEGRAM
[2025-11-19T12:44:18.330Z] –û—à–∏–±–∫–∞ polling: ETELEGRAM
[2025-11-19T12:44:25.705Z] –û—à–∏–±–∫–∞ polling: ETELEGRAM
[2025-11-19T12:44:33.066Z] –û—à–∏–±–∫–∞ polling: ETELEGRAM
[2025-11-19T12:44:40.499Z] –û—à–∏–±–∫–∞ polling: ETELEGRAM
[2025-11-19T12:44:47.905Z] –û—à–∏–±–∫–∞ polling: ETELEGRAM
[2025-11-19T12:44:55.258Z] –û—à–∏–±–∫–∞ polling: ETELEGRAM
[2025-11-19T12:45:02.685Z] –û—à–∏–±–∫–∞ polling: ETELEGRAM
[2025-11-19T12:45:10.038Z] –û—à–∏–±–∫–∞ polling: ETELEGRAM
[2025-11-19T12:45:17.406Z] –û—à–∏–±–∫–∞ polling: ETELEGRAM
[2025-11-19T12:45:24.795Z] –û—à–∏–±–∫–∞ polling: ETELEGRAM
[2025-11-19T12:45:32.223Z] –û—à–∏–±–∫–∞ polling: ETELEGRAM
[2025-11-19T12:45:39.817Z] –û—à–∏–±–∫–∞ polling: ETELEGRAM
[2025-11-19T12:45:47.161Z] –û—à–∏–±–∫–∞ polling: ETELEGRAM
[2025-11-19T12:45:54.544Z] –û—à–∏–±–∫–∞ polling: ETELEGRAM
[2025-11-19T12:46:02.089Z] –û—à–∏–±–∫–∞ polling: ETELEGRAM
[2025-11-19T12:46:09.554Z] –û—à–∏–±–∫–∞ polling: ETELEGRAM
[2025-11-19T12:46:17.564Z] –û—à–∏–±–∫–∞ polling: ETELEGRAM
[2025-11-19T12:46:24.909Z] –û—à–∏–±–∫–∞ polling: ETELEGRAM
[2025-11-19T12:46:32.259Z] –û—à–∏–±–∫–∞ polling: ETELEGRAM
[2025-11-19T12:46:39.674Z] –û—à–∏–±–∫–∞ polling: ETELEGRAM
[2025-11-19T12:46:46.998Z] –û—à–∏–±–∫–∞ polling: ETELEGRAM
[2025-11-19T12:46:54.403Z] –û—à–∏–±–∫–∞ polling: ETELEGRAM
